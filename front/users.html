<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>사용자(fetch)</title>
  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <nav class="container">
    <a href="./index.html">홈</a>
    <a href="./calc.html">연산/함수</a>
    <a class="active" href="./users.html">사용자(fetch)</a>
    <a href="./todos.html">할 일(localStorage)</a>
    <a href="./prefs.html">설정(쿠키)</a>
  </nav>

  <main class="container">
    <h2>사용자 목록</h2>
    <input id="q" placeholder="이름/이메일 검색" />
    <div id="list" class="list">
  </main>

  <script>
    const listEl = document.querySelector("#list");
    const searchEl = document.querySelector("#q");
    let allUsers = [];
    // 사용자 목록을 화면에 렌더링하는 함수
    function renderUsers(users) {
      listEl.innerHTML = ""; // 기존 목록을 비웁니다.
      users.forEach(user => {
        const card = document.createElement("div");
        card.classList.add("card");
        card.innerHTML = `
          <strong>${user.name}</strong> <span class="small">${user.email}</span><br />
          <span class="small">${user.address.city}</span>
        `;
        listEl.appendChild(card);
      });
    }




    // 코드 작성
    // - https://jsonplaceholder.typicode.com/users 데이터 가져오기

    const url = "https://jsonplaceholder.typicode.com/users";
    fetch(url)
      .then(res => res.json())
      .then(data => {
        allUsers = data;
        renderUsers(allUsers);
      });

    searchEl.addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      const filteredUsers = allUsers.filter(user => {
        return user.name.toLowerCase().includes(query) ||
          user.email.toLowerCase().includes(query);
      });
      renderUsers(filteredUsers);

    });

  </script>
</body>

</html>